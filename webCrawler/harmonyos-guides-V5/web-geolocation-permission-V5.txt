管理位置权限
Web组件提供位置权限管理能力。开发者可以通过onGeolocationShow()接口对某个网站进行位置权限管理。Web组件根据接口响应结果，决定是否赋予前端页面权限。
 使用获取设备位置功能前请在module.json5中添加位置相关权限，权限的添加方法请参考在配置文件中声明权限。 \"requestPermissions\":[\n   {\n     \"name\" : \"ohos.permission.LOCATION\"\n   },\n   {\n     \"name\" : \"ohos.permission.APPROXIMATELY_LOCATION\"\n   },\n   {\n     \"name\" : \"ohos.permission.LOCATION_IN_BACKGROUND\"\n   }\n ] 
在下面的示例中，用户点击前端页面\"获取位置\"按钮，Web组件通过弹窗的形式通知应用侧位置权限请求消息。
 前端页面代码。 <!DOCTYPE html>\n<html>\n<body>\n<p id=\"locationInfo\">位置信息</p>\n<button onclick=\"getLocation()\">获取位置</button>\n<script>\nvar locationInfo=document.getElementById(\"locationInfo\");\nfunction getLocation(){\n  if (navigator.geolocation) {\n    <!-- 前端页面访问设备地理位置 -->\n    navigator.geolocation.getCurrentPosition(showPosition);\n  }\n}\nfunction showPosition(position){\n  locationInfo.innerHTML=\"Latitude: \" + position.coords.latitude + \"<br />Longitude: \" + position.coords.longitude;\n}\n</script>\n</body>\n</html> 应用代码。 // xxx.ets\nimport { webview } from '@kit.ArkWeb';\nimport { BusinessError } from '@kit.BasicServicesKit';\nimport { abilityAccessCtrl, common } from '@kit.AbilityKit';\n\nlet context = getContext(this) as common.UIAbilityContext;\nlet atManager = abilityAccessCtrl.createAtManager();\n\n// 向用户请求位置权限设置。\natManager.requestPermissionsFromUser(context, [\"ohos.permission.APPROXIMATELY_LOCATION\"]).then((data) => {\n  console.info('data:' + JSON.stringify(data));\n  console.info('data permissions:' + data.permissions);\n  console.info('data authResults:' + data.authResults);\n}).catch((error: BusinessError) => {\n  console.error(`Failed to request permissions from user. Code is ${error.code}, message is ${error.message}`);\n})\n\n@Entry\n@Component\nstruct WebComponent {\n  controller: webview.WebviewController = new webview.WebviewController();\n\n  build() {\n    Column() {\n      Web({ src: $rawfile('getLocation.html'), controller: this.controller })\n        .geolocationAccess(true)\n        .onGeolocationShow((event) => { // 地理位置权限申请通知\n          AlertDialog.show({\n            title: '位置权限请求',\n            message: '是否允许获取位置信息',\n            primaryButton: {\n              value: 'cancel',\n              action: () => {\n                if (event) {\n                  event.geolocation.invoke(event.origin, false, false); // 不允许此站点地理位置权限请求\n                }\n              }\n            },\n            secondaryButton: {\n              value: 'ok',\n              action: () => {\n                if (event) {\n                  event.geolocation.invoke(event.origin, true, false); // 允许此站点地理位置权限请求\n                }\n              }\n            },\n            cancel: () => {\n              if (event) {\n                event.geolocation.invoke(event.origin, false, false); // 不允许此站点地理位置权限请求\n              }\n            }\n          })\n        })\n    }\n  }\n} 
