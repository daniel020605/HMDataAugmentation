hvigor-config.json5
hvigor提供hvigor-config.json5文件，以指定hvigor的版本、构建依赖以及构建行为的配置参数。
参数
是否必填
类型
说明
modelVersion
是
string
当前工程中hvigor版本。
dependencies
是
object
当前工程执行构建任务时，依赖的构建插件及版本，为npm源组件。
execution
否
object
执行构建的相关配置参数。
analyze
否
string | boolean
构建分析模式。
normal（默认值）：普通模式，通过简单打点数据进行分析。原default模式已废弃。advanced：进阶模式，通过更加详细的打点数据进行分析。如果需要更详细的任务耗时数据，请选择该模式。原verbose模式已废弃。false：不启用构建分析。
daemon
否
boolean
是否启用守护进程编译。
true（缺省默认值）：启用。false：不启用。
incremental
否
boolean
是否启用增量编译。
true（缺省默认值）：启用。false：不启用。
parallel
否
boolean
是否启用并行编译。
true（缺省默认值）：启用。false：不启用。
typeCheck
否
boolean
是否启用构建脚本hvigorfile.ts文件的类型检查，启用后构建效率可能会有所降低。
true：启用。false（缺省默认值）：不启用。
logging
否
object
日志相关配置参数。
level
否
string
构建时打印日志的级别。
debug：调测日志。info（缺省默认值）：基本信息日志。warn：告警日志。error：错误日志。
debugging
否
object
调测相关配置参数。
stacktrace
否
boolean
是否启用堆栈跟踪。
true：启用。false（缺省默认值）：不启用。
nodeOptions
否
object
Node相关配置参数。
maxOldSpaceSize
否
number
启用守护进程编译时，守护进程内存大小，单位为MB。当工程代码量较大出现JS内存溢出时，可以调整该参数。
启用守护进程编译但未配置该参数时，将使用Node默认的内存大小配置。
exposeGC
否
boolean
是否启用GC（Garbage Collection，内存回收），启用后会优化编译过程的峰值内存。
true（缺省默认值）：启用。false：不启用。
properties
否
object
额外配置参数。
hvigor.cacheDir
否
string
指定项目根目录下的.hvigor缓存文件夹的存放路径。
同名的不同工程不可指定相同的存放位置。
ohos.buildDir
否
string
指定项目的构建产物目录（build目录）存放位置。
同名的不同工程不可指定相同的存放位置。
enableSignTask
否
boolean
是否启用HAP或HSP签名任务。
true（缺省默认值）：启用。false：不启用。
ohos.arkCompile.maxSize
否
number
指定编译ArkTS线程的数量，默认为5。
hvigor.pool.maxSize
否
number
指定编译过程中的线程数量，相比ohos.arkCompile.maxSize增加签名、打包等任务的线程。默认值为“工程的模块数”和“电脑虚拟核数-1”两者的较小值。
ohos.pack.compressLevel
否
string
设置打包hap（压缩so）或app（压缩hap）时的压缩率等级。压缩率越高，压缩速度越慢。
fast（缺省默认值）：最低等级的压缩率，压缩速度最快。standard：适中等级的压缩率，压缩速度适中。ultimate：最高等级的压缩率，压缩速度最慢。
hvigor.analyzeHtml
否
boolean
是否生成构建可视化html文件。
true：生成构建可视化html文件。生成的html文件存放在工程的.hvigor/report目录下，该文件可直接在浏览器中打开。false（缺省默认值）：不生成构建可视化html文件。
hvigor.dependency.useNpm
否
boolean
指定是否使用npm下载hvigor依赖。
若未配置该字段，当Node.js版本 ≥ 16时，默认使用pnpm下载依赖。在某些特定场景，可以通过配置该字段指定使用npm下载依赖。
true：对于任意Node版本，都使用npm下载依赖。false（缺省默认值）：Node.js版本 ≥ 16时，使用pnpm下载依赖；Node.js版本 ＜ 16时，使用npm下载依赖。
ohos.compile.lib.entryfile
否
boolean
指定是否从入口文件开始编译：
true：表示从模块的入口文件开始编译，将编译入口文件及被引用的文件，没被引用的文件不会参与编译流程。false（缺省默认值）：表示将src/main/ets下的ets和ts文件进行全量编译，涉及到以下场景：构建HSP时，存在于src/main/ets下的ets和ts文件都会被编译到产物中。release模式对HAR混淆或构建字节码HAR时，存在于src/main/ets下的ets和ts文件都会被编译到产物中。构建HAP/HSP时，存在于动态依赖的HAR模块src/main/ets下的ets和ts文件都会被编译到产物中。 
ohos.align.target
否
string
指定本次构建任务所有涉及到的模块及其依赖的模块的target。详情请参考多产物构建target。
ohos.fallback.target
否
array
指定本次构建任务所有涉及到的模块及其依赖模块的fallback target，fallback target是一个特定优先级的target，各target的优先级顺序：align target > 命令行指定target > 被依赖的父模块target > fallback target > default target。详情请参考多产物构建target。
ohos.arkCompile.sourceMapDir
否
string
指定sourceMap文件的生成路径，方便开发者进行堆栈的回栈与错误信息的定位，当前仅支持Stage模型。若没有指定路径，默认生成在build/default/outputs/default/mapping下。
HAR：release模式下文件会生成在指定或默认路径，debug模式不会生成文件。HAP/HSP：debug模式下文件会生成在指定或默认路径，同时在build/default/intermediates/loader_out/default/ets下也有一份sourceMap文件，release模式不会生成文件。
从API 12开始支持。
hvigor.enableMemoryCache
否
boolean
是否开启缓存，开启缓存会加快增量编译速度，关闭缓存能够节省内存占用，但是会增加增量编译时间。
true（缺省默认值）：开启。false：不开启。
hvigor.memoryThreshold
否
number
内存管理阈值，单位为MB，当编译构建占用内存超过此阈值时，新加入的编译任务会等待，直到正在进行的编译任务结束，新的编译任务才能开始，此配置将导致编译时间延长。
配置该字段后，即使hvigor.enableMemoryCache配置为true，也不进行缓存。该字段配置为很小的值时，构建任务会串行执行，等效于配置ohos.arkCompile.maxSize:1；配置为很大的值时，与不配置没有差异。
ohos.nativeResolver
否
boolean
ArkTS编译过程中是否使用高性能插件进行依赖寻址，使用高性能插件可以降低编译过程的峰值内存，加快编译速度。
true（缺省默认值）：使用。false：不使用。
ohos.sign.har
否
boolean
是否启用HAR签名任务。详情请参考构建签名HAR。
true：启用。false（缺省默认值）：不启用。
hvigor.keepDependency
否
boolean
是否保持hsp中的所有依赖。如果保持则不对依赖进行处理，如果不保持，则只会保留hsp模块中的hsp相关依赖。
true（缺省默认值）：保持。false：不保持。
hvigor-config.json5的示例如下所示：
{\n  \"modelVersion\": \"5.0.0\",  // hvigor基础构建能力版本\n  \"dependencies\": {\n  },\n  \"execution\": {\n    // \"analyze\": \"normal\",              /* 构建分析模式 */\n    // \"daemon\": true,                          /* 是否启用守护进程编译 */\n    // \"incremental\": true,                     /* 是否启用增量编译 */\n    // \"parallel\": true,                        /* 是否启用并行编译 */\n    // \"typeCheck\": false,                      /* 是否启用类型检查 */\n  },\n  \"logging\": {\n    // \"level\": \"info\"                          /* 定义日志级别 */\n  },\n  \"debugging\": {\n    // \"stacktrace\": false                      /* 是否启用堆栈跟踪编译 */\n  },\n  \"nodeOptions\": {\n    // \"maxOldSpaceSize\": 4096                  /* 启用守护进程编译时，守护进程内存大小，单位为MB。 */\n    // \"exposeGC\": true                         /* 是否启用GC */\n  }\n}
