转换指定页面或指定区域为图片
场景介绍
PDF文档页面转换为图片，或将页面的指定区域转换为图片时使用。
接口说明
接口名
描述
getPagePixelMap(): image.PixelMap
获取当前页的图片。
getCustomPagePixelMap(matrix: PdfMatrix, isGray: boolean, drawAnnotations: boolean): image.PixelMap
获取指定PdfPage区域的图片内容。
getAreaPixelMap(matrix: PdfMatrix, bitmapwidth: number, bitmapHeight: number, isGray: boolean, drawAnnotations: boolean): image.PixelMap
获取指定PdfPage区域的图片内容，并指定图片的宽和高。
示例代码
 调用loadDocument方法加载PDF文档。 调用getPage方法获取某个页面。 调用getPagePixelMap或getCustomPagePixelMap方法获取当前页面或者页面区域，这时获取的是image.PixelMap图像类型。 将image.PixelMap图像类型转化为二进制图片文件并保存，参考以下方法pixelMap2Buffer。 
import { pdfService } from '@kit.PDFKit';\nimport { image } from '@kit.ImageKit';\nimport { fileIo as fs } from '@kit.CoreFileKit';\nimport { common } from '@kit.AbilityKit';\nimport { BusinessError } from '@kit.BasicServicesKit';\n\n@Entry\n@Component\nstruct PdfPage {\n  private pdfDocument: pdfService.PdfDocument = new pdfService.PdfDocument();\n  private context = getContext() as common.UIAbilityContext;\n  private loadResult: pdfService.ParseResult = pdfService.ParseResult.PARSE_ERROR_FORMAT;\n\n  aboutToAppear(): void {\n    // 确保沙箱目录有input.pdf文档\n    let filePath = this.context.filesDir + '/input.pdf';\n    this.loadResult = this.pdfDocument.loadDocument(filePath);\n  }\n\n  // 将 pixelMap 转成图片格式\n  pixelMap2Buffer(pixelMap: image.PixelMap): Promise<ArrayBuffer> {\n    return new Promise((resolve, reject) => {\n      /**\n       设置打包参数\n       format：图片打包格式，只支持 jpg 和 webp\n       quality：JPEG 编码输出图片质量\n       bufferSize：图片大小，默认 10M\n       */\n      let packOpts: image.PackingOption = { format: 'image/jpeg', quality: 98 }\n      // 创建ImagePacker实例\n      const imagePackerApi = image.createImagePacker()\n      imagePackerApi.packToData(pixelMap, packOpts).then((buffer: ArrayBuffer) => {\n        resolve(buffer)\n      }).catch((err: BusinessError) => {\n        reject()\n      })\n    })\n  }\n\n  build() {\n    Column() {\n      // 获取为图片并保存到应用沙箱\n      Button('getPagePixelMap').onClick(async () => {\n        if (this.loadResult === pdfService.ParseResult.PARSE_SUCCESS) {\n          let page = this.pdfDocument.getPage(0)\n          let pixmap: image.PixelMap = page.getPagePixelMap();\n          if (!pixmap) {\n            return\n          }\n          const imgBuffer = await this.pixelMap2Buffer(pixmap)\n          const file =\n            fs.openSync(this.context.filesDir + `/${Date.now()}.png`, fs.OpenMode.READ_WRITE | fs.OpenMode.CREATE);\n          await fs.write(file.fd, imgBuffer)\n          // 关闭文档\n          await fs.close(file.fd)\n        }\n      })\n      // 获取指定PdfPage区域的图片内容。\n      Button('getCustomPagePixelMap').onClick(async () => {\n        if (this.loadResult === pdfService.ParseResult.PARSE_SUCCESS) {\n          let page = this.pdfDocument.getPage(0);\n          let matrix = new pdfService.PdfMatrix();\n          matrix.x = 100;\n          matrix.y = 100;\n          matrix.width = 500;\n          matrix.height = 500;\n          matrix.rotate = 0;\n          let pixmap: image.PixelMap = page.getCustomPagePixelMap(matrix, false, false);\n          if (!pixmap) {\n            return;\n          }\n          const imgBuffer = await this.pixelMap2Buffer(pixmap);\n          const file =\n            fs.openSync(this.context.filesDir + `/${Date.now()}.jpeg`, fs.OpenMode.READ_WRITE | fs.OpenMode.CREATE);\n          await fs.write(file.fd, imgBuffer);\n          // 关闭文件\n          await fs.close(file.fd);\n        }\n      })\n      // 获取指定PdfPage区域的图片内容\n      Button('getAreaPixelMap').onClick(async () => {\n        if (this.loadResult === pdfService.ParseResult.PARSE_SUCCESS) {\n          let page = this.pdfDocument.getPage(0);\n          let matrix = new pdfService.PdfMatrix();\n          matrix.x = 100;\n          matrix.y = 100;\n          matrix.width = 500;\n          matrix.height = 500;\n          matrix.rotate = 0;\n          let pixmap: image.PixelMap = page.getAreaPixelMap(matrix, 400, 400, true, false);\n          if (!pixmap) {\n            return\n          }\n          const imgBuffer = await this.pixelMap2Buffer(pixmap)\n          const file =\n            fs.openSync(this.context.filesDir + `/${Date.now()}.bmp`, fs.OpenMode.READ_WRITE | fs.OpenMode.CREATE);\n          await fs.write(file.fd, imgBuffer)\n          // 关闭文件\n          await fs.close(file.fd);\n        }\n      })\n    }\n  }\n}
