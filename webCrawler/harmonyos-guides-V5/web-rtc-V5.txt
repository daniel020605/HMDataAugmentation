使用WebRTC进行Web视频会议
Web组件可以通过W3C标准协议接口拉起摄像头和麦克风，通过onPermissionRequest接口接收权限请求通知，需在配置文件中声明相应的音频权限。
 使用摄像头和麦克风功能前请在module.json5中添加音频相关权限，权限的添加方法请参考在配置文件中声明权限。  // src/main/resources/base/element/string.json\n {\n   \"name\": \"reason_for_camera\",\n   \"value\": \"reason_for_camera\"\n },\n {\n   \"name\": \"reason_for_microphone\",\n   \"value\": \"reason_for_microphone\"\n }   // src/main/module.json5\n  \"requestPermissions\":[\n    {\n      \"name\" : \"ohos.permission.CAMERA\",\n      \"reason\": \"$string:reason_for_camera\",\n      \"usedScene\": {\n        \"abilities\": [\n          \"EntryAbility\"\n        ],\n        \"when\":\"inuse\"\n      }\n    },\n    {\n      \"name\" : \"ohos.permission.MICROPHONE\",\n      \"reason\": \"$string:reason_for_microphone\",\n      \"usedScene\": {\n        \"abilities\": [\n          \"EntryAbility\"\n        ],\n        \"when\":\"inuse\"\n      }\n    }\n  ], 
通过在JavaScript中调用W3C标准协议接口navigator.mediaDevices.getUserMedia()，该接口用于拉起摄像头和麦克风。constraints参数是一个包含了video和audio两个成员的MediaStreamConstraints对象，用于说明请求的媒体类型。
在下面的示例中，点击前端页面中的开起摄像头按钮再点击onConfirm，打开摄像头和麦克风。
 应用侧代码。 // xxx.ets\nimport { webview } from '@kit.ArkWeb';\nimport { BusinessError } from '@kit.BasicServicesKit';\nimport { abilityAccessCtrl } from '@kit.AbilityKit';\n\n@Entry\n@Component\nstruct WebComponent {\n  controller: webview.WebviewController = new webview.WebviewController()\n\n  aboutToAppear() {\n    // 配置Web开启调试模式\n    webview.WebviewController.setWebDebuggingAccess(true);\n    // 获取权限请求通知，点击onConfirm按钮后，拉起摄像头和麦克风。\n    let atManager = abilityAccessCtrl.createAtManager();\n    atManager.requestPermissionsFromUser(getContext(this), ['ohos.permission.CAMERA', 'ohos.permission.MICROPHONE'])\n      .then((data) => {\n        console.info('data:' + JSON.stringify(data));\n        console.info('data permissions:' + data.permissions);\n        console.info('data authResults:' + data.authResults);\n      }).catch((error: BusinessError) => {\n      console.error(`Failed to request permissions from user. Code is ${error.code}, message is ${error.message}`);\n    })\n  }\n\n  build() {\n    Column() {\n      Web({ src: $rawfile('index.html'), controller: this.controller })\n        // 获取权限请求通知，点击onConfirm按钮后，拉起摄像头和麦克风。\n        .onPermissionRequest((event) => {\n          if (event) {\n            AlertDialog.show({\n              title: 'title',\n              message: 'text',\n              primaryButton: {\n                value: 'deny',\n                action: () => {\n                  event.request.deny();\n                }\n              },\n              secondaryButton: {\n                value: 'onConfirm',\n                action: () => {\n                  event.request.grant(event.request.getAccessibleResource());\n                }\n              },\n              cancel: () => {\n                event.request.deny();\n              }\n            })\n          }\n        })\n    }\n  }\n} 前端页面index.html代码。 <!-- index.html -->\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"UTF-8\">\n</head>\n<body>\n<video id=\"video\" width=\"500px\" height=\"500px\" autoplay=\"autoplay\"></video>\n<canvas id=\"canvas\" width=\"500px\" height=\"500px\"></canvas>\n<br>\n<input type=\"button\" title=\"HTML5摄像头\" value=\"开启摄像头\" onclick=\"getMedia()\"/>\n<script>\n  function getMedia()\n  {\n    let constraints = {\n      video: {width: 500, height: 500},\n      audio: true\n    };\n    // 获取video摄像头区域\n    let video = document.getElementById(\"video\");\n    // 返回的Promise对象\n    let promise = navigator.mediaDevices.getUserMedia(constraints);\n    // then()异步，调用MediaStream对象作为参数\n    promise.then(function (MediaStream) {\n      video.srcObject = MediaStream;\n      video.play();\n    });\n  }\n</script>\n</body>\n</html> 
