概述
简介
轻量化工具是一款集模型压缩算法和网络结构搜索算法于一体的自动模型轻量化工具，针对NPU架构对深度神经网络模型进行深度的模型优化，可以帮助用户自动地完成模型轻量化以及网络结构的生成任务。目前支持无训练模式、插件式量化模式和网络结构搜索。
无训练量化：用户可以直接输入模型，无需重训练，快速的完成模型轻量化。适用于快捷方便量化的用户使用。
插件式量化：为用户提供模型量化API，在用户训练工程中对浮点模型进行量化模型校准或量化模型重训练，易用性高，插件式重训练量化适用于较高精度要求的用户。网络结构搜索：支持分类网络、检测网络、分割网络三种网络类型。用户配置相应的搜索参数和接口函数后，使用网络结构搜索工具进行搜索，在设定的算力约束下，得到优秀的网络模型。适用于需要自动生成网络结构的用户。
模式
支持的框架
支持的策略
支持的设备
无训练量化
TensorFlow、PyTorch、ONNX
Quant_INT8-8
同时支持CPU和GPU模式，GPU支持单机单卡。
插件式量化
TensorFlow、PyTorch
Quant_INT8-8
支持GPU，支持单机单卡。
网络结构搜索
TensorFlow、PyTorch
NASEA
支持GPU，支持单机单卡和单机多卡。
通过模型轻量化以及网络结构搜索获得模型在NPU上的收益可以参见模型收益。
Quant_INT8-8：权重8bit量化，数据8bit量化。
经过轻量化工具小型化后的模型，可以使用OMG转换工具转为OM离线模型，使用方式可参见量化模型转换。
该轻量化工具位于“tools_dopt”目录下。
目录文件
描述说明
tools_dopt/dopt_tf_py3
TensorFlow框架无训练，插件式量化，网络结构搜索的工具入口以及demo。
tools_dopt/dopt_pytorch_py3
PyTorch框架无训练，插件式量化，网络结构搜索的工具入口以及demo。
tools_dopt/dopt_onnx_py3
ONNX框架无训练工具入口。
支持范围
支持Linux环境，Ubuntu 22.04。插件式支持GPU训练，单机单卡训练。无训练支持CPU和GPU量化。网络结构搜索工具支持单机单卡和单机多卡，进行分类、检测、分割场景的骨架搜索，依赖运行环境参见环境准备。
系统要求
TensorFlow用户使用本工具需同时满足下列环境要求：Python 3.10Ubuntu 22.04Tensorflow 2.8.0GPU需要使用支持CUDA的显卡（无训练量化可不配置） PyTorch用户使用本工具需同时满足下列环境要求：Python 3.10Ubuntu 22.04PyTorch 1.11opencv-pythonGPU需要使用支持CUDA的显卡（无训练量化可不配置） 
ONNX用户使用本工具需同时满足下列环境要求：Python 3.10Ubuntu 22.04ONNX Runtime 1.15ONNX 1.14 
用户指引
下面列举了不同用户场景对应的步骤和工具链功能。用户可以根据下表中列举的不同场景选择适宜的优化方式。
[h2]TensorFlow用户
用户场景
使用依赖
工具链提供功能
使用限制
建议使用工具
优势
缺少足量数据集和训练资源追求高易用性
可运行TensorFlow环境模型pb文件（需要用户自行转换）校准集
Quant_INT8-8
无
TensorFlow无训练量化
无需TensorFlow编写代码，新手用户友好
对精度要求较高有足够数据集和训练资源有一定编程能力持有模型训练工程
可运行TensorFlow环境模型的ckpt文件训练集测试集用户需要在训练工程中调用轻量化工具API量化模型并进行重训练
Quant_INT8-8
无
TensorFlow插件式量化
模型精度可保障
需要自动生成符合需求的网络结构
环境准备训练集测试集用户需要根据说明书编写模型接口代码
搜索生成网络结构
无
网络结构搜索训练
可根据用户提供的配置信息自动搜索到在特定场景上表现优秀的网络结构
[h2]PyTorch用户
用户场景
使用依赖
工具链提供功能
使用限制
建议使用工具
优势
缺少足量数据集和训练资源追求高易用性
可运行PyTorch环境模型参数文件pthpython模型定义校准集
Quant_INT8-8
无
PyTorch无训练量化
无需PyTorch编写代码，新手用户友好
对精度要求较高有足够数据集和训练资源有一定编程能力
可运行PyTorch环境模型参数文件pth训练集测试集用户需要调用轻量化工具API量化模型并进行重训练
Quant_INT8-8
无
PyTorch插件式量化
模型精度可保障
需要自动生成符合需求的网络结构
环境准备训练集测试集用户需要根据说明书编写模型接口代码
搜索生成网络结构
无
网络结构搜索训练
可根据用户提供的配置信息自动搜索到在特定场景上表现优秀的网络结构
[h2]ONNX用户
用户场景
用户需要准备
工具链提供功能
使用限制
建议使用工具
优势
缺少足量数据集和训练资源追求高易用性
可运行ONNX Runtime环境ONNX model校准集
Quant_INT8-8
无
ONNX模型无训练量化
无需编写代码，新手用户友好
